<%-include("../layout/head")%>
    <%-include("../layout/header")%>
        <%-include("../layout/sidebar")%>   
        
    <div class="col-sm-9 col-sm-offset-3 col-lg-10 col-lg-offset-2 main">           
        <div class="row">
            <ol class="breadcrumb mt-3">
                <li><a href="/admin"><svg class="glyph stroked home"><use xlink:href="#stroked-home"></use></svg></a></li>
                <li class="active">Quản lý danh mục</li>
            </ol>
        </div>        
        <div class="row">
            <div class="col-lg-12">
                <h1 class="page-header">Quản lý danh mục</h1>
            </div>
        </div>
        
        <% if (typeof success !== 'undefined' && success.length > 0) { %>
            <div class="alert alert-success"><%= success %></div>
        <% } %>
        
        <% if (typeof errors !== 'undefined' && errors.length > 0) { %>
            <div class="alert alert-danger">
                <ul>
                    <% errors.forEach(error => { %>
                        <li><%= Array.isArray(error) ? error[0].msg : error.msg %></li> 
                    <% }) %>
                </ul>
            </div>
        <% } %>
        
        <div id="toolbar" class="btn-group">
            <a href="/admin/categories/create" class="btn btn-success">
                <i class="glyphicon glyphicon-plus"></i> Thêm danh mục
            </a>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <table 
                            data-toolbar="#toolbar"
                            data-toggle="table">
        
                            <thead>
                            <tr>
                                <th data-field="id" data-sortable="true">ID</th>
                                <th>Tên danh mục</th>
                                <th>Hành động</th>
                            </tr>
                            </thead>
                            <tbody>
                                <% let i = 1 + (page - 1) * 10 %> 
                                <% for(let category of categories) { %>
                                    <tr>
                                        <td><%= i++ %></td>
                                        <td><%= category.name %></td>
                                        <td class="form-group">
                                            <a href="/admin/categories/edit/<%= category._id %>" class="btn btn-primary"><i class="glyphicon glyphicon-pencil"></i></a>
                                            <a href="/admin/categories/delete/<%= category._id %>" class="btn btn-danger" onclick="return confirm('Bạn có chắc muốn xóa danh mục <%= category.name %> này không?');"><i class="glyphicon glyphicon-remove"></i></a>
                                        </td>
                                    </tr>
                                <% } %>
                            </tbody>
                        </table>
                    </div>
                    <div class="panel-footer">
                        <nav aria-label="Page navigation example">
                            <ul class="pagination">
                                <li class="page-item <%= page === 1 ? 'disabled' : '' %>">
                                    <a class="page-link" href="/admin/categories?page=<%= prev %>">&laquo;</a>
                                </li>
                                <% for (let pageNumber of paginate) { %>
                                    <% if (pageNumber==="..." ) { %>
                                        <li class="page-item disabled"><a class="page-link" href="#">...</a></li>
                                    <% } else { %>
                                        <li class="page-item <%= page === pageNumber ? 'active' : '' %>">
                                            <a class="page-link" href="/admin/categories?page=<%= pageNumber %>">
                                                <%= pageNumber %>
                                            </a>
                                        </li>
                                    <% } %>
                                <% } %>
                                <li class="page-item <%= page === totalPages ? 'disabled' : '' %>">
                                    <a class="page-link" href="/admin/categories?page=<%= next %>">&raquo;</a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>  <script src="/static/admin/js/jquery-1.11.1.min.js"></script>
    <script src="/static/admin/js/bootstrap.min.js"></script>
    <script src="/static/admin/js/bootstrap-table.js"></script>   
<%-include("../layout/footer")%>